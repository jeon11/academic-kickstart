<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jin Jeon">

  
  
  
    
  
  <meta name="description" content="This script runs through sample experiment data from manually reading in raw file to preprocessing through applying filters, eye blink detection using peak finding techniques. Then we create epochs and plot evoked responses.">

  
  <link rel="alternate" hreflang="en-us" href="https://jinjeon.me/post/eeg-basics/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=https://fonts.googleapis.com/css2?family=Open+Sans:wght@300&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jinjeon.me/post/eeg-basics/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Jin Jeon">
  <meta property="og:url" content="https://jinjeon.me/post/eeg-basics/">
  <meta property="og:title" content="EEG/Signal Processing--Basics Part 1 | Jin Jeon">
  <meta property="og:description" content="This script runs through sample experiment data from manually reading in raw file to preprocessing through applying filters, eye blink detection using peak finding techniques. Then we create epochs and plot evoked responses."><meta property="og:image" content="https://jinjeon.me/post/eeg-basics/featured.png">
  <meta property="twitter:image" content="https://jinjeon.me/post/eeg-basics/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2018-05-01T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2018-05-01T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jinjeon.me/post/eeg-basics/"
  },
  "headline": "EEG/Signal Processing--Basics Part 1",
  
  "image": [
    "https://jinjeon.me/post/eeg-basics/featured.png"
  ],
  
  "datePublished": "2018-05-01T00:00:00Z",
  "dateModified": "2018-05-01T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Jin Jeon"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Jin Jeon",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jinjeon.me/img/icon.png"
    }
  },
  "description": "This script runs through sample experiment data from manually reading in raw file to preprocessing through applying filters, eye blink detection using peak finding techniques. Then we create epochs and plot evoked responses."
}
</script>

  

  


  


  





  <title>EEG/Signal Processing--Basics Part 1 | Jin Jeon</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/"><img src="/img/icon.png" alt="Jin Jeon"></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About Me</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/pdf/JinJeon_Resume.pdf" target="_blank" rel="noopener"><span>Resume</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span></span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>EEG/Signal Processing--Basics Part 1</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Tue, May 1, 2018
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    12 min read
  </span>
  

  
  
  

  
  

</div>

  














</div>


<div class="article-header container featured-image-wrapper mt-4 mb-4" style="max-width: 460px; max-height: 209px;">
  <div style="position: relative">
    <img src="/post/eeg-basics/featured.png" alt="" class="featured-image">
    <span class="article-header-caption">example ERP</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h3 id="note">Note:</h3>
<p>This post is a ported version of Jupyter Notebook from my mne-eeg project: <a href="https://github.com/jeon11/mne-egi/blob/master/walkthrough_basics.ipynb">https://github.com/jeon11/mne-egi/blob/master/walkthrough_basics.ipynb</a>
<!-- raw HTML omitted --></p>
<h2 id="overview">Overview</h2>
<p>This script runs through sample experiment data from manually reading in raw file to preprocessing through applying filters, eye blink detection using peak finding techniques. Then we create epochs and plot evoked responses.</p>
<p>In the advanced walkthrough: <a href="https://github.com/jeon11/mne-egi/blob/master/walkthrough_advanced.ipynb">walkthrough_advanced.ipynb</a>, we implement independent component analysis (ICA) and autoreject, which is an automated tool for fixing data, to see how the epochs are improved and compare the evoked responses by conditions.</p>
<p>The script requires at least two files:</p>
<ul>
<li>the raw data <a href="https://drive.google.com/file/d/1W2UFu_6H4HzFF2DALAxfmr0BNSj7pEok/view?usp=sharing">(download from Google Drive ~500MB)</a></li>
<li>exported event text log from NetStation software</li>
</ul>
<h3 id="running-the-script-in-command-line">Running the script in command line</h3>
<p>When running the Python script from command line, MNE recommends using ipython via:</p>
<pre tabindex="0"><code>ipython —-pylab osx -i mne-egi-walkthrough.py
</code></pre><p>For Windows, instead of <code>osx</code>, you would be specifying <code>qt</code>.</p>
<h3 id="importing">Importing</h3>
<p>Let&rsquo;s begin by importing all the necessary modules. Make sure you have all the required dependencies setup.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> mne
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> matplotlib
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot <span style="color:#66d9ef">as</span> plt
<span style="color:#f92672">from</span> mne.preprocessing <span style="color:#f92672">import</span> eog
<span style="color:#f92672">from</span> mne.preprocessing <span style="color:#f92672">import</span> create_eog_epochs
<span style="color:#f92672">from</span> mne.preprocessing.peak_finder <span style="color:#f92672">import</span> peak_finder
<span style="color:#f92672">import</span> Tkinter
<span style="color:#f92672">import</span> extract_nslog_event
</code></pre></div><h3 id="setting-basic-variables">Setting basic variables</h3>
<p>Before we begin any preprocessing, we create variables here to specify what we want to look for. The whole script basically requires two main files.</p>
<ol>
<li>raw_fname: The raw instance of eeg data file in .raw format</li>
<li>ns_eventlog: Netstation&rsquo;s event exports in text</li>
</ol>
<p>The <code>selection</code> variable is later used to specify which channels to plot and compare. Note, the first item in the <code>selection</code> list, <code>EB</code> channel is a virtual channel created from bipolar referene.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># specify sample subject data directory</span>
raw_fname   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/Users/Jin/Documents/MATLAB/research/mne-egi/data/sfv_eeg_011ts.raw&#39;</span>
ns_eventlog <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/Users/Jin/Documents/MATLAB/research/mne-egi/data/sfv_eeg_011ts_nsevent&#39;</span>

<span style="color:#75715e"># specify sub-sample of channels to look in detail</span>
selection <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;EB&#39;</span>,<span style="color:#e6db74">&#39;E11&#39;</span>,<span style="color:#e6db74">&#39;E24&#39;</span>,<span style="color:#e6db74">&#39;E124&#39;</span>,<span style="color:#e6db74">&#39;E36&#39;</span>,<span style="color:#e6db74">&#39;E104&#39;</span>,<span style="color:#e6db74">&#39;E52&#39;</span>,<span style="color:#e6db74">&#39;E62&#39;</span>,<span style="color:#e6db74">&#39;E92&#39;</span>]
</code></pre></div><h3 id="reading-in-raw-file">Reading in raw file</h3>
<p>Raw eeg data can be read in with a simple line below. You can specify montage kind in strings. See <a href="https://martinos.org/mne/dev/generated/mne.channels.read_montage.html">https://martinos.org/mne/dev/generated/mne.channels.read_montage.html</a> for available montages. We set <code>preload=True</code> because some of the preprocessing functions require raw file to be preloaded.</p>
<p>Once the raw file is loaded, typing <code>raw</code> and <code>raw.info</code> will show details about the raw instance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print(<span style="color:#e6db74">&#39;reading raw file...&#39;</span>)
raw <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>io<span style="color:#f92672">.</span>read_raw_egi(raw_fname, montage<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;GSN-HydroCel-128&#39;</span>, preload<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
print(<span style="color:#e6db74">&#39;Done!&#39;</span>)
</code></pre></div><pre><code>reading raw file...


&lt;ipython-input-3-8bc42ae4bead&gt;:2: RuntimeWarning: The following EEG sensors did not have a position specified in the selected montage: ['E129']. Their position has been left untouched.
  raw = mne.io.read_raw_egi(raw_fname, montage='GSN-HydroCel-128', preload=True)


Done!
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print(raw)
<span style="color:#75715e"># see the first ten list of channel names (note by default, prefix &#39;E&#39; is appended)</span>
print(raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;ch_names&#39;</span>][<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">10</span>])

<span style="color:#75715e"># see highpass &amp; lowpass filter</span>
print(<span style="color:#e6db74">&#39;highpass filter: &#39;</span> <span style="color:#f92672">+</span> str(raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;highpass&#39;</span>]))
print(<span style="color:#e6db74">&#39;lowpass filter: &#39;</span> <span style="color:#f92672">+</span> str(raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;lowpass&#39;</span>]))
</code></pre></div><pre><code>&lt;RawEGI  |  sfv_eeg_011ts.raw, n_channels x n_times : 136 x 989490 (4947.4 sec), ~1.00 GB, data loaded&gt;
['E1', 'E2', 'E3', 'E4', 'E5', 'E6', 'E7', 'E8', 'E9', 'E10']
highpass filter: 0.0
lowpass filter: 100.0
</code></pre>
<h2 id="applying-bandpass-filter">Applying bandpass filter</h2>
<p>Our first preprocessing step will be applying the bandpass filter of 1Hz and 30Hz. The numbers can be played around with, but this filter range will potentially remove general noise from environment and slow drifting signals. Other suggestions for highpass is 0.1; for 40 Hz lowpass.</p>
<p>After bandpass filter is applied, type <code>raw.info</code> to check how <code>raw.filter</code> made changes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># apply bandpass filter to raw file (highpass, lowpass)</span>
raw<span style="color:#f92672">.</span>filter(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">30</span>)

<span style="color:#75715e"># see highpass &amp; lowpass filter</span>
print(<span style="color:#e6db74">&#39;highpass filter: &#39;</span> <span style="color:#f92672">+</span> str(raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;highpass&#39;</span>]))
print(<span style="color:#e6db74">&#39;lowpass filter: &#39;</span> <span style="color:#f92672">+</span> str(raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;lowpass&#39;</span>]))
</code></pre></div><pre><code>highpass filter: 1.0
lowpass filter: 30.0
</code></pre>
<h2 id="creating-meta-dataframe">Creating meta dataframe</h2>
<p>We will deviate a little from processing raw file, and construct a dataframe that can be later used for effectively creating epochs or querying information we just need. This part uses the custom built module (also experiment specific as each experiment will have different paradigms and event tags). The <code>extract_nslog_event</code> constructs necessary pandas dataframe from <code>ns_eventlog</code> text file which we specified earlier in #Setting-basic-variables.</p>
<p><code>create_df</code> returns five dataframes, in which nsdata is a list from simply csv-read file that is used to create task-specific pandas dataframes. For example, <code>df_lst</code> is the initial dataframe created that includes all practice, trials, and sentences tasks. The rest of dfs contain task specific data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># create pandas data frames for different tasks</span>
nsdata, df_lst, df_plst, df_tlst, df_slst <span style="color:#f92672">=</span> extract_nslog_event<span style="color:#f92672">.</span>create_df(ns_eventlog)
</code></pre></div><pre><code>creating data frame from ns event log...
dataframes created for subject 011
trials found: 800
sentences found: 200
</code></pre>
<p>From now on, for simplicity sake, we will only examine the actual trials task part in this walkthrough. We can focus on looking at the data structure of trials task. Since the dataframe is already created specifically for trials, what we really want now is the onset (sample numbers) of when the event occured and the condition of the stimuli that was presented.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># show data frame structure of 2rd index</span>
print(df_tlst<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">2</span>])
</code></pre></div><pre><code>code      tlst
label     lstS
onset    99867
cond         4
indx         1
Name: 2, dtype: object
</code></pre>
<p>The label for trials task was either a last word start (lstS) or last word end (lstE). Since we are interested in the onset of the word, we will extract just the onsets using the custom code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># create onset-only data frame (event tag specifications)</span>
df_tlstS <span style="color:#f92672">=</span> extract_nslog_event<span style="color:#f92672">.</span>create_df_onset(df_tlst)
<span style="color:#75715e"># show total events of interest</span>
len(df_tlstS)
</code></pre></div><pre><code>400
</code></pre>
<h2 id="finding-impedance-check-periods-and-annotating">Finding impedance check periods and annotating</h2>
<p>Now that we have dataframes setup, we continue to clean up the raw data. Throughout the acquisition, we ran impedance checks to make sure that all electrodes were in good contact with the scalp and that good signal is being read in. During the impedance check, the waveforms peak in extreme amount and we want to make note of these periods, telling the mne functions to avoid and ignore such periods.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># find impedance onsets</span>
imp_onset, imp_offset, imp_dur <span style="color:#f92672">=</span> extract_nslog_event<span style="color:#f92672">.</span>find_impedances(nsdata)

<span style="color:#75715e"># annotate on raw with &#39;bad&#39; tags (params `reject_by_annotation` will search for &#39;bad&#39; tags later)</span>
annot_imp <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>Annotations(imp_onset, imp_dur, [<span style="color:#e6db74">&#34;bad imp&#34;</span>] <span style="color:#f92672">*</span> len(imp_onset), orig_time<span style="color:#f92672">=</span>raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;meas_date&#39;</span>])
raw<span style="color:#f92672">.</span>set_annotations(annot_imp)
</code></pre></div><pre><code>finding impedance periods...
found 4 impedance periods!





&lt;RawEGI  |  sfv_eeg_011ts.raw, n_channels x n_times : 136 x 989490 (4947.4 sec), ~1.00 GB, data loaded&gt;
</code></pre>
<h2 id="marking-bad-channels">Marking bad channels</h2>
<p>We also want to make note of bad channels. We can manually inspect for bad channels by seeing the actual raw data.  <code>raw.plot</code> will show the actual raw file with annotations from above marked as red segments. You can inspect for good/bad channels and manually click on bad channels to mark them bad. Once you manually inspected the channels, type <code>raw.info['bads']</code> to see how it is updated.</p>
<p>Note that the plot below is a static figure for example sake. Running the code in ipython will allow us to horizontally and vertically scroll through data. Clicking on a channel will mark that channel red and be considered red. You can see that we&rsquo;ve ran four impedance checks throughout the session (1 task switch period, every 100th trials out fo 400).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># block=True is useful because it will wait to whatever change you make in the raw file at the plot stage</span>
print(raw<span style="color:#f92672">.</span>plot(bad_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, block<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>))
</code></pre></div><p><img src="./walkthrough_basics_19_0.png" alt="png"></p>
<pre><code>Figure(782.64x483.12)
</code></pre>
<p>If you already had a list of bad channels noted during the acquisition period, you can skip the above manual inspection and simply specify the bad channels with a line of code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;bads&#39;</span>] <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;E127&#39;</span>, <span style="color:#e6db74">&#39;E107&#39;</span>, <span style="color:#e6db74">&#39;E49&#39;</span>, <span style="color:#e6db74">&#39;E48&#39;</span>, <span style="color:#e6db74">&#39;E115&#39;</span>, <span style="color:#e6db74">&#39;E113&#39;</span>, <span style="color:#e6db74">&#39;E122&#39;</span>, <span style="color:#e6db74">&#39;E121&#39;</span>, <span style="color:#e6db74">&#39;E123&#39;</span>, <span style="color:#e6db74">&#39;E108&#39;</span>, <span style="color:#e6db74">&#39;E63&#39;</span>, <span style="color:#e6db74">&#39;E1&#39;</span>]
print(raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;bads&#39;</span>])
</code></pre></div><pre><code>['E127', 'E107', 'E49', 'E48', 'E115', 'E113', 'E122', 'E121', 'E123', 'E108', 'E63', 'E1']
</code></pre>
<h2 id="detecting-and-rejecting-eye-blinks">Detecting and rejecting eye blinks</h2>
<p>We&rsquo;ve so far applied generic/broad preprocessing steps, such as bandpass filters, marking chunks of bad segments, and marking bad channels. Now we will look at finding eye blinks in the raw and add more annotations to mark those samples bad.</p>
<h3 id="step-1-setting-bipolar-reference">Step 1: Setting bipolar reference</h3>
<p>Because the cap we use do not have EOG-specific channels, we use the channels that are nearest to the eyes and consider those as our virtual eye channels. Thus, such method has the risk of the eye channels actually not having just the eye-related oscillations. This is done by setting the bipolar reference, which is basically the subtraction of two opposing channels (ie. the top and bottom of each eye for eye blinks; the left and right of the eyes for eye movements).</p>
<p>Here, we use just the right side of the eye only to detect eye blinks. From the subtraction of channel E8 and E126, a virtual channel EB is created.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># let&#39;s begin eye artifact detections</span>
print(<span style="color:#e6db74">&#39;Starting EOG artifact detection&#39;</span>)
raw <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>set_bipolar_reference(raw, [<span style="color:#e6db74">&#39;E8&#39;</span>],[<span style="color:#e6db74">&#39;E126&#39;</span>],[<span style="color:#e6db74">&#39;EB&#39;</span>])

<span style="color:#75715e"># specify this as the eye channel</span>
raw<span style="color:#f92672">.</span>set_channel_types({<span style="color:#e6db74">&#39;EB&#39;</span>: <span style="color:#e6db74">&#39;eog&#39;</span>})

<span style="color:#75715e"># double check the changes</span>
<span style="color:#75715e"># print(raw.info[&#39;chs&#39;])</span>
</code></pre></div><pre><code>Starting EOG artifact detection
</code></pre>
<h3 id="step-2-detecting-eye-blinks">Step 2: Detecting eye blinks</h3>
<p>Now that we have a virtual eye channel to inspect, we can try to identify any eye blinks. Because the virtual eye channel that is created from subtraction of the channels, the waveform of EB channel will be generally flat. You can inspect this by <code>raw.plot</code>.</p>
<p>Eye blinks are generally characterized as two eye channels having sudden opposing peaks. So the methodology is to find a sudden peak within the flat EB line. We have the options of:</p>
<ol>
<li>finding eye blinks via mne built in function</li>
<li>finding eye blinks via scipy peak finding method</li>
</ol>
<p>Both results in similar eye blink detections because the methodology of finding local peaks. We will only use the mne built in function and comment out the custom built function that uses scipy. <code>reject_by_annotation</code> will ignore the bad segments marked as bad earlier. The threshold of 0.0001 can be played around with but it is a reasonable threshold set after having manually inspect the data. The <code>events_eog</code> will be an array with [sample number, 0, eventlabel in number]</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">events_eog <span style="color:#f92672">=</span> eog<span style="color:#f92672">.</span>find_eog_events(raw, reject_by_annotation<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, thresh<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0001</span>, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)

<span style="color:#75715e"># type `help(scipy_annotate_eyeblinks)` for detail</span>
<span style="color:#75715e"># raw = scipy_annotate_eyeblinks(raw, &#39;EB&#39;, 100)</span>

print(<span style="color:#e6db74">&#39;number of eye blinks detected: &#39;</span> <span style="color:#f92672">+</span> str(len(events_eog)))
</code></pre></div><pre><code>number of eye blinks detected: 1720
</code></pre>
<p><code>events_eog</code> above will give where the eye blinks occured in samples. We will convert the sample number to seconds so we can annotate on the raw file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># get just the sample numbers from the eog events</span>
eog_sampleN <span style="color:#f92672">=</span> [i[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> events_eog]
<span style="color:#75715e"># convert to seconds for annotation-friendly purposes</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(eog_sampleN)):
    eog_sampleN[i] <span style="color:#f92672">=</span> eog_sampleN[i] <span style="color:#f92672">/</span> float(<span style="color:#ae81ff">200</span>)

<span style="color:#75715e"># set annotation</span>
annot_eog <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>Annotations(eog_sampleN, [<span style="color:#ae81ff">0.1</span>] <span style="color:#f92672">*</span> len(eog_sampleN),
                            [<span style="color:#e6db74">&#34;bad eye&#34;</span>] <span style="color:#f92672">*</span> len(eog_sampleN), orig_time <span style="color:#f92672">=</span> raw<span style="color:#f92672">.</span>info[<span style="color:#e6db74">&#39;meas_date&#39;</span>])
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># add this eye blink annotation to the previous annotation by simply adding</span>
new_annot <span style="color:#f92672">=</span> annot_imp <span style="color:#f92672">+</span> annot_eog
raw<span style="color:#f92672">.</span>set_annotations(new_annot)
print(<span style="color:#e6db74">&#39;new annotation set!&#39;</span>)
</code></pre></div><pre><code>new annotation set!
</code></pre>
<p>Now that new annotation is set, let&rsquo;s see the changes made to the raw. Again we will just have a figure printed out here. You can see the bad channels marked red (like E1), and bunch of red bars that potentially mark spikes/eye blinks. Because the Times x-axis is so zoomed out, we see all parts being red, but as we see the plot above, that is actually not true. We see that &lsquo;bad eye&rsquo; is annotated for any potential peaks in the &lsquo;EB&rsquo; channel that is newly created from bipolar reference.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># you can check that more red segments are marked on the raw file</span>
print(raw<span style="color:#f92672">.</span>plot(bad_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>))
</code></pre></div><p><img src="./walkthrough_basics_30_0.png" alt="png"></p>
<pre><code>Figure(782.64x483.12)
</code></pre>
<h2 id="setting-rereference">Setting rereference</h2>
<p>Now that bad channels are marked and we know which bad segments to avoid, we will set eeg reference (We want to avoid doing reference before the bad data are marked and rejected).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print(<span style="color:#e6db74">&#39;setting eeg reference...&#39;</span>)
raw<span style="color:#f92672">.</span>set_eeg_reference(<span style="color:#e6db74">&#39;average&#39;</span>, projection<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</code></pre></div><pre><code>setting eeg reference...





&lt;RawEGI  |  sfv_eeg_011ts.raw, n_channels x n_times : 135 x 989490 (4947.4 sec), ~1019.5 MB, data loaded&gt;
</code></pre>
<h2 id="creating-epochs">Creating epochs</h2>
<p>Now that we have done some primary artifact detections, we can create a first look on how our epochs look. Epochs are time-locked events of interest. Here, we look at the few hundred milliseconds before and after the onset of the last word of a sentence presentation. Before creating the epochs, we will run some custom codes to update the event arrays accordingly so the event labels are properly labeled ie. 1 for onsets, 2 for offsets.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># first find events related to tlst stim channel in the cleaned raw</span>
events_tlst <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>find_events(raw, stim_channel<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tlst&#39;</span>)

<span style="color:#75715e"># events_tlst is a array structure ie.  (1, 0, 1) and so far, the all the event tags are 1 which is not true</span>
<span style="color:#75715e"># We will update the event tags with 1s and 2s with custom built function</span>

<span style="color:#75715e"># update event ids in mne events array and double check sampling onset timing as sanity check</span>
events_tlstS <span style="color:#f92672">=</span> extract_nslog_event<span style="color:#f92672">.</span>assign_event_id(df_tlst, events_tlst)
</code></pre></div><pre><code>updating mne event array and double checking sampling onset time...
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># epoching initially with metadata applied</span>
event_id_tlst <span style="color:#f92672">=</span> dict(lstS<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
tmin <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.25</span>  <span style="color:#75715e"># start of each epoch</span>
tmax <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>  <span style="color:#75715e"># end of each epoch</span>
<span style="color:#75715e"># set baseline to 0</span>
baseline <span style="color:#f92672">=</span> (tmin, <span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># picks specify which channels we are interested</span>
picks <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>pick_types(raw<span style="color:#f92672">.</span>info, meg<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, eeg<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, eog<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, stim<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, exclude<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bads&#39;</span>)

<span style="color:#75715e"># `metadata` field is used to put in our comprehensive pandas dataframe</span>
<span style="color:#75715e"># it is useful for later creating evoked responses by conditions</span>
epochs_tlstS <span style="color:#f92672">=</span> mne<span style="color:#f92672">.</span>Epochs(raw, events_tlstS, event_id_tlst, tmin, tmax, proj<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, picks<span style="color:#f92672">=</span>picks,
                          baseline<span style="color:#f92672">=</span>baseline, preload<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, reject<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, reject_by_annotation<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, metadata<span style="color:#f92672">=</span>df_tlstS)
print(<span style="color:#e6db74">&#39;epochs_tlstS:&#39;</span>)
print(epochs_tlstS)
</code></pre></div><pre><code>epochs_tlstS:
&lt;Epochs  |   388 events (all good), -0.25 - 0.8 sec, baseline [-0.25, 0], ~72.8 MB, data loaded, with metadata,
 'lstS': 388&gt;
</code></pre>
<p>We created epochs named <code>epochs_tlstS</code> which is mne&rsquo;s epochs instance. Note that the epochs are 388 instead of original 400. It is likely that the some epochs are dropped from annotations. Let&rsquo;s see if it&rsquo;s true.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># show drop percentage from mne.Epochs</span>
drop_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(epochs_tlstS<span style="color:#f92672">.</span>drop_log)):
    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;bad eye&#39;</span> <span style="color:#f92672">in</span> epochs_tlstS<span style="color:#f92672">.</span>drop_log[j]:
        drop_count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
print(str(drop_count) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; epochs dropped by eog annotation&#39;</span>)
print(<span style="color:#e6db74">&#39;perecentage dropped: &#39;</span> <span style="color:#f92672">+</span> str(epochs_tlstS<span style="color:#f92672">.</span>drop_log_stats()))
</code></pre></div><pre><code>12 epochs dropped by eog annotation
perecentage dropped: 3.0
</code></pre>
<h2 id="creating-evoked-response-erp">Creating evoked response (ERP)</h2>
<p>Everything looks good. We can create an evoked response by condition. Currently, the epochs_tlst contains all four conditions of the task. By creating an evoked response by condition, we can examine the data for each condition.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># create evoked respone using pandas query based on metadata created from previous epochs</span>
evoked_tlst_c1 <span style="color:#f92672">=</span> epochs_tlstS[<span style="color:#e6db74">&#34;label==&#39;lstS&#39; and cond==&#39;1&#39;&#34;</span>]<span style="color:#f92672">.</span>average()
evoked_tlst_c2 <span style="color:#f92672">=</span> epochs_tlstS[<span style="color:#e6db74">&#34;label==&#39;lstS&#39; and cond==&#39;2&#39;&#34;</span>]<span style="color:#f92672">.</span>average()
evoked_tlst_c3 <span style="color:#f92672">=</span> epochs_tlstS[<span style="color:#e6db74">&#34;label==&#39;lstS&#39; and cond==&#39;3&#39;&#34;</span>]<span style="color:#f92672">.</span>average()
evoked_tlst_c4 <span style="color:#f92672">=</span> epochs_tlstS[<span style="color:#e6db74">&#34;label==&#39;lstS&#39; and cond==&#39;4&#39;&#34;</span>]<span style="color:#f92672">.</span>average()
</code></pre></div><p>Evoked responses are created by condition. Let&rsquo;s just inspect the first one. The figure below will show the waveforms of all channels (except the ones marked bad and bipolar referenced channels) with total N epochs in that condition. Originally, N=100 for each condition.</p>
<p>We can see something happening at 100ms to 300ms range after the onset of the word, which is time point 0s.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print(evoked_tlst_c1<span style="color:#f92672">.</span>plot())
</code></pre></div><p><img src="./walkthrough_basics_41_0.png" alt="png"></p>
<pre><code>Figure(460.8x216)
</code></pre>
<p>Figure above is in black and could be hard to inspect. A more interesting plot could be using <code>plot_joint</code> method. You can see that most of the channels in the frontal region are showing flat, insignificant patterns. On the other hand, the right occipital (marked in red, purplish colors) is revealing potentially interesting results.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">print(evoked_tlst_c1<span style="color:#f92672">.</span>plot_joint(times<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;peaks&#39;</span>))
</code></pre></div><pre><code>/Users/Jin/Library/Python/2.7/lib/python/site-packages/mne/transforms.py:689: RuntimeWarning: invalid value encountered in divide
  out[:, 2] = np.arccos(cart[:, 2] / out[:, 0])
</code></pre>
<p><img src="./walkthrough_basics_43_1.png" alt="png"></p>
<pre><code>Figure(576x302.4)
</code></pre>
<p>To avoid going through the same process everytime you load in a subject, we can save the progress by saving the resulted epochs (ie. <code>epochs_tlstS</code> or raw instance). In the other notebook, we will continue with more advanced artifact detection using the saved epochs.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">epochs_tlstS<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;epochs_tlsts-epo.fif&#39;</span>, split_size<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2GB&#39;</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;single&#39;</span>, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</code></pre></div><h2 id="sources-and-useful-links">Sources and useful links</h2>
<p>MNE querying metadata: <a href="https://martinos.org/mne/stable/auto_examples/preprocessing/plot_metadata_query.html">https://martinos.org/mne/stable/auto_examples/preprocessing/plot_metadata_query.html</a></p>
<p>MNE annotations: <a href="https://martinos.org/mne/stable/generated/mne.Annotations.html">https://martinos.org/mne/stable/generated/mne.Annotations.html</a></p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/python/">python</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://jinjeon.me/post/eeg-basics/&amp;text=EEG/Signal%20Processing--Basics%20Part%201" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://jinjeon.me/post/eeg-basics/&amp;t=EEG/Signal%20Processing--Basics%20Part%201" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=EEG/Signal%20Processing--Basics%20Part%201&amp;body=https://jinjeon.me/post/eeg-basics/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://jinjeon.me/post/eeg-basics/&amp;title=EEG/Signal%20Processing--Basics%20Part%201" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_huf5029b22bbb9407d45fad41834988009_176697_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://jinjeon.me/">Jin Jeon</a></h5>
      <h6 class="card-subtitle">UX Researcher</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://jinjeon.me/pdf/JinJeon_Resume.pdf" target="_blank" rel="noopener">
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/jinjeon/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/jeon11" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:jinjeon@berkeley.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python,%20r.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.b59fdb6275ef5e6e2859c30582fc271a.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © 2023 developed by Jin with HTML/CSS/Markdown and ☕️ <!-- raw HTML omitted --> &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
